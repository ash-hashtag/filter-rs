lot of code duplication, fix it
